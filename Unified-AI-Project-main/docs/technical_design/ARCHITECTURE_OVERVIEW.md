# 🏗️ 技术架构概览

## 📋 系统全貌

Unified-AI-Project 是一个多代理协作的 AI 系统，采用分布式、服务导向的架构。

```
┌─────────────────────────────────────────────────────────────┐
│                    用户界面层                                │
├─────────────────┬─────────────────┬─────────────────────────┤
│   Web API       │   CLI 接口      │   Electron 桌面应用      │
│  (FastAPI)      │                │                         │
└─────────────────┴─────────────────┴─────────────────────────┘
                           │
┌─────────────────────────────────────────────────────────────┐
│                    核心协调层                                │
├─────────────────────────────────────────────────────────────┤
│  DialogueManager (对话管理) ←→ ProjectCoordinator (项目协调)  │
│                           │                                 │
│                    AgentManager (代理管理)                   │
└─────────────────────────────────────────────────────────────┘
                           │
                    HSP 通信协议
                           │
┌─────────────────────────────────────────────────────────────┐
│                    专门代理层                                │
├─────────────────┬─────────────────┬─────────────────────────┤
│   创作代理       │   数据分析代理   │   图像生成代理           │
│   搜索代理       │   翻译代理       │   其他专门代理...        │
└─────────────────┴─────────────────┴─────────────────────────┘
                           │
┌─────────────────────────────────────────────────────────────┐
│                    工具和服务层                              │
├─────────────────┬─────────────────┬─────────────────────────┤
│   HAM 记忆系统   │   LLM 接口      │   工具调度器             │
│   数据存储       │   外部 API      │   文件系统工具           │
└─────────────────┴─────────────────┴─────────────────────────┘
```

## 🔧 核心组件

### 1. 通信协议 - HSP
- **作用**: 所有组件间的通信标准
- **特点**: 异步消息传递、事件驱动
- **传输**: 基于 MQTT 消息代理
- **文档**: [HSP 快速入门](./HSP_QUICK_START.md)

### 2. 记忆系统 - HAM
- **全称**: Hierarchical Abstractive Memory (分层抽象记忆)
- **作用**: 智能数据存储和检索
- **特点**: 多层次、语义化、可扩展
- **文档**: [HAM 设计规范](./architecture/HAM_design_spec.md)

### 3. 代理框架 - Fragmenta
- **作用**: 代理的创建、管理和协作框架
- **特点**: 模块化、可插拔、自适应
- **文档**: [Fragmenta 设计规范](./architecture/Fragmenta_design_spec.md)

### 4. 对话管理 - DialogueManager
- **作用**: 处理用户输入，协调系统响应
- **特点**: 智能路由、上下文管理
- **位置**: `src/core_ai/dialogue/dialogue_manager.py`

## 🔄 工作流程

### 典型请求处理流程
```
1. 用户输入 → 用户界面
2. 用户界面 → DialogueManager
3. DialogueManager 分析请求复杂度
4. 简单请求 → 直接响应
5. 复杂请求 → ProjectCoordinator
6. ProjectCoordinator → 任务分解
7. 通过 HSP → 分发给专门代理
8. 代理执行 → 调用工具/服务
9. 结果汇总 → 返回用户
```

### 代理协作流程
```
1. 代理注册能力 → ServiceDiscovery
2. 任务请求 → HSP 广播
3. 匹配代理响应 → 能力声明
4. 任务分配 → 选定代理
5. 执行任务 → 调用工具
6. 结果返回 → HSP 消息
7. 结果整合 → ProjectCoordinator
```

## 🎯 关键特性

### ✅ 已实现
- ✅ 基础 HSP 通信协议
- ✅ DialogueManager 核心功能
- ✅ 多种用户界面 (Web/CLI/Desktop)
- ✅ 基础代理系统
- ✅ 工具调度器
- ✅ HAM 记忆系统基础

### 🚧 开发中
- 🚧 完整的代理发现机制
- 🚧 高级 HAM 功能
- 🚧 Fragmenta 完整实现
- 🚧 语言免疫系统 (LIS)
- 🚧 深度映射功能

### 📋 计划中
- 📋 多模态支持
- 📋 分布式部署
- 📋 高级安全机制
- 📋 性能优化

## 🛠️ 技术栈

### 后端
- **Python 3.8+**: 主要开发语言
- **FastAPI**: Web API 框架
- **MQTT**: 消息传输协议
- **SQLite/PostgreSQL**: 数据存储

### 前端
- **React + TypeScript**: Web 界面
- **Electron**: 桌面应用
- **Tailwind CSS**: 样式框架

### AI/ML
- **Google Gemini**: 默认 LLM
- **Transformers**: 模型加载
- **Sentence Transformers**: 语义搜索

## 📚 深入学习路径

### 🚀 入门级
1. [项目概述](../../README.md)
2. [HSP 快速入门](./HSP_QUICK_START.md)
3. [术语表](../GLOSSARY.md)

### 🔧 开发级
1. [项目章程](../PROJECT_CHARTER.md)
2. [代理协作框架](./architecture/AGENT_COLLABORATION_FRAMEWORK.md)
3. [技术规范目录](../technical_specs/)

### 🏗️ 架构级
1. [HAM 设计规范](./architecture/HAM_design_spec.md)
2. [HSP 完整规范](./HSP_SPECIFICATION.md)
3. [Fragmenta 设计规范](./architecture/Fragmenta_design_spec.md)

## ❓ 常见问题

**Q: 系统如何保证代理间通信的可靠性？**
A: 通过 HSP 协议的消息确认机制和 MQTT 的 QoS 保证。

**Q: 如何添加新的代理？**
A: 实现 HSP 接口，注册到 ServiceDiscovery，系统会自动发现。

**Q: 系统支持多少个并发代理？**
A: 理论上无限制，实际受硬件资源限制，建议监控系统性能。

---

*本文档提供系统架构的高层概览。详细技术实现请参考各专门文档。*